# 解决腾讯云 Cloudbase 403 错误

## 问题原因

403 错误通常是因为**腾讯云 Cloudbase 的安全域名配置没有添加你的 Vercel 域名**，导致访问被拒绝。

## 解决步骤

### 第 1 步：获取你的 Vercel 域名

从 Vercel 部署页面复制你的完整域名，例如：
```
https://fix-orcin.vercel.app
```

### 第 2 步：在腾讯云控制台配置安全域名

1. **登录腾讯云控制台**
   - 访问：https://console.cloud.tencent.com/
   - 找到并进入 **云开发 Cloudbase**（或搜索 "Cloudbase"）

2. **进入你的环境**
   - 找到环境 ID 为 `cloud1-0g7vmmxz0edb5524` 的环境
   - 点击进入环境详情

3. **配置安全域名**
   - 在左侧菜单找到 **安全配置** 或 **安全** → **安全域名**
   - 点击 **添加域名** 或 **编辑**
   - 添加以下域名（每个一行）：
     ```
     localhost
     localhost:3000
     fix-orcin.vercel.app
     *.vercel.app
     ```
   - **注意**：
     - 只需要写域名，不需要 `https://`
     - `*.vercel.app` 可以匹配所有 Vercel 子域名
     - 或者直接填写你的完整域名 `fix-orcin.vercel.app`

4. **保存配置**
   - 点击 **保存** 或 **确定**
   - 等待 1-2 分钟让配置生效

### 第 3 步：检查匿名登录是否开启

1. 在腾讯云 Cloudbase 控制台，进入你的环境
2. 找到 **登录授权** 或 **身份认证**
3. 确认 **匿名登录** 已开启
4. 如果未开启，请开启并保存

### 第 4 步：检查数据库权限

1. 在腾讯云 Cloudbase 控制台，进入你的环境
2. 找到 **数据库** → **数据权限**
3. 确认 `pendingRequests` 集合的权限设置：
   - **读取权限**：设置为 `所有用户可读` 或 `仅创建者可读`
   - **创建权限**：设置为 `所有用户可创建` 或 `仅登录用户可创建`
   - **更新权限**：根据需要设置
   - **删除权限**：设置为 `仅创建者可删除` 或 `所有用户可删除`（根据你的需求）

### 第 5 步：刷新页面测试

1. 回到你的 Vercel 网站
2. 按 `Ctrl + Shift + R`（Windows）或 `Cmd + Shift + R`（Mac）强制刷新
3. 打开浏览器开发者工具（F12）→ Console
4. 查看是否还有 403 错误

## 如果仍然失败

如果配置后仍然有 403 错误，请检查：

1. **环境 ID 是否正确**
   - 确认 `tencentcloud.ts` 中的环境 ID 与腾讯云控制台显示的一致
   - 格式应该是：`cloud1-xxxxx`

2. **数据库集合是否存在**
   - 在数据库列表中确认 `pendingRequests` 集合已创建

3. **查看详细错误信息**
   - 打开浏览器 Console，查看完整的错误信息
   - 告诉我具体的错误代码和消息

